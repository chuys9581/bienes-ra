<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Inventario - Inmobiliaria Elite</title>
    <link rel="stylesheet" href="admin.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body>
    <div class="admin-container">
        <!-- 1. LEFT SIDEBAR -->
        <aside class="sidebar-left">
            <div class="sidebar-header">
                <div class="logo-icon" id="sidebarLogoIcon">eP</div>
                <h2 id="sidebarCompanyName">eProduct</h2>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-section="dashboard">
                    <span class="material-icons">dashboard</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-section="propiedades">
                    <span class="material-icons">home_work</span>
                    <span>Propiedades</span>
                </a>
                <a href="#" class="nav-item" data-section="agentes">
                    <span class="material-icons">people</span>
                    <span>Agentes</span>
                </a>

                <a href="#" class="nav-item mt-auto" data-section="configuracion">
                    <span class="material-icons">settings</span>
                    <span>Configuraci√≥n</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <a href="#" class="footer-link">Ayuda</a>
                <a href="#" class="footer-link">Contacto</a>
            </div>
        </aside>

        <!-- 2. MAIN CONTENT -->
        <main class="main-content">
            <!-- Header -->
            <header class="top-header">
                <div class="header-titles">
                    <h1>Hola, <span id="userNameHeader">Admin</span> üëã</h1>
                    <p>Bienvenido de nuevo a tu panel.</p>
                </div>
                <div class="header-actions">
                    <div class="search-bar">
                        <span class="material-icons">search</span>
                        <input type="text" placeholder="Search..." id="searchInput">
                    </div>
                    <button class="btn-icon">
                        <span class="material-icons">notifications</span>
                        <span class="notification-dot"></span>
                    </button>
                </div>
            </header>

            <!-- Dashboard Content (GRAPHS) -->
            <div id="sectionDashboard" class="content-section active">
                <div class="charts-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem;">
                    <!-- Graph 1: Properties by Status -->
                    <div class="card-wide" style="min-height: 400px;">
                        <h3>Propiedades por Estado</h3>
                        <div style="position: relative; height: 300px; width: 100%;">
                            <canvas id="propiedadesChart"></canvas>
                        </div>
                    </div>

                    <!-- Graph 2: Properties by Agent -->
                    <div class="card-wide" style="min-height: 400px;">
                        <h3>Propiedades por Agente</h3>
                        <div style="position: relative; height: 300px; width: 100%;">
                            <canvas id="agentesChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Propiedades Content (TABLE MOVED HERE) -->
            <div id="sectionPropiedades" class="content-section">
                <div class="bottom-grid" style="grid-template-columns: 1fr;">
                    <!-- Properties Table -->
                    <div class="card-wide">
                        <div class="card-header-flex">
                            <h3>Inventario de Propiedades</h3>
                            <button class="btn-success-sm" id="btnAddProperty">
                                <span class="material-icons">add</span>
                            </button>
                        </div>
                        <div class="properties-table-container">
                            <table class="clean-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Propiedad</th>
                                        <th>Precio</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="propertiesTableBody">
                                    <tr>
                                        <td colspan="5">Cargando...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agents Content -->
            <div id="sectionAgentes" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Gesti√≥n de Agentes</h1>
                    <button class="btn-success" id="btnAddAgent">
                        <span class="material-icons">person_add</span>
                        Agregar Agente
                    </button>
                </div>
                <div class="agents-grid" id="agentsGrid"></div>
            </div>

            <!-- Configuraci√≥n Content -->
            <div id="sectionConfiguracion" class="content-section">
                <div class="page-header">
                    <h1 class="page-title">Configuraci√≥n</h1>
                </div>
                <div class="card-wide" style="max-width: 600px;">
                    <form id="configForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="configCompanyName">Nombre de la Empresa</label>
                                <input type="text" id="configCompanyName" class="form-input" placeholder="Ej: eProduct"
                                    required>
                            </div>
                            <div class="form-group">
                                <label for="configCompanyIconFile">Icono / Logo (Imagen)</label>
                                <input type="file" id="configCompanyIconFile" class="form-input" accept="image/*">
                                <div id="currentIconPreview" style="margin-top: 0.5rem;"></div>
                                <small style="display:block; margin-top:0.5rem; color:#6B7280;">Suba una imagen para el
                                    icono del men√∫.</small>
                            </div>
                        </div>
                        <div style="margin-top: 1.5rem;">
                            <button type="submit" class="btn-success" style="padding: 0.75rem 1.5rem;">
                                <span class="material-icons">check</span>
                                Guardar Cambios
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>

        <!-- 3. RIGHT SIDEBAR -->
        <aside class="right-sidebar">
            <div class="search-icon-mobile">
                <span class="material-icons">search</span>
            </div>

            <div class="user-profile-widget">
                <div class="user-avatar-large" id="userAvatar">A</div>
                <h3 id="userName">User Name</h3>
                <p id="userRole">Admin</p>
                <span class="user-level-badge">Level 1</span>
            </div>

            <div class="stats-widgets">
                <div class="stat-item">
                    <span class="stat-num" id="totalPropiedades">0</span>
                    <span class="stat-label">Propiedades</span>
                </div>
                <div class="stat-item">
                    <span class="stat-num" id="totalAgentes">0</span>
                    <span class="stat-label">Agentes</span>
                </div>
            </div>

            <div class="perf-item">
                <div class="perf-icon bg-blue-light"><span class="material-icons">trending_up</span></div>
                <div class="perf-info">
                    <span class="perf-value" id="propGrowthVal">0%</span>
                    <span class="perf-label">Crecimiento Propiedades</span>
                </div>
            </div>

            <div class="perf-item">
                <div class="perf-icon bg-pink-light"><span class="material-icons">group_add</span></div>
                <div class="perf-info">
                    <span class="perf-value" id="agentGrowthVal">0%</span>
                    <span class="perf-label">Crecimiento Agentes</span>
                </div>
            </div>

            <div class="logout-area">
                <button class="btn-logout-full" id="btnLogout">
                    <span class="material-icons">logout</span>
                    Salir
                </button>
            </div>
    </div>
    </aside>
    </div>

    <!-- ==================== MODAL: Agregar/Editar Propiedad ==================== -->
    <div id="propertyModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Agregar Propiedad</h2>
                <button class="modal-close" id="closeModal">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="propertyForm">
                    <input type="hidden" id="propertyId">

                    <div class="form-row">
                        <div class="form-group">
                            <label>T√≠tulo</label>
                            <input type="text" id="titulo" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Descripci√≥n</label>
                            <textarea id="descripcion" rows="4"></textarea>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Tipo de Propiedad</label>
                            <select id="tipo_propiedad_id" required>
                                <option value="">Seleccionar...</option>
                                <option value="1">Casa</option>
                                <option value="2">Departamento</option>
                                <option value="3">Terreno</option>
                                <option value="4">Local Comercial</option>
                                <option value="5">Oficina</option>
                                <option value="6">Bodega</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Moneda</label>
                            <select id="moneda" required>
                                <option value="USD">USD - D√≥lar Estadounidense</option>
                                <option value="MXN">MXN - Peso Mexicano</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Precio</label>
                            <div style="position: relative; display: flex; align-items: center;">
                                <span id="currencySymbol" style="position: absolute; left: 12px; color: #64748B; font-weight: 500;">$</span>
                                <input type="text" id="precioDisplay" placeholder="0" required style="padding-left: 28px;">
                                <input type="hidden" id="precio">
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Direcci√≥n</label>
                            <input type="text" id="direccion" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Ciudad</label>
                            <input type="text" id="ciudad" required>
                        </div>

                        <div class="form-group">
                            <label>Estado</label>
                            <select id="estado" required>
                                <option value="">Seleccionar estado...</option>
                                <option value="Aguascalientes">Aguascalientes</option>
                                <option value="Baja California">Baja California</option>
                                <option value="Baja California Sur">Baja California Sur</option>
                                <option value="Campeche">Campeche</option>
                                <option value="Chiapas">Chiapas</option>
                                <option value="Chihuahua">Chihuahua</option>
                                <option value="Ciudad de M√©xico">Ciudad de M√©xico</option>
                                <option value="Coahuila">Coahuila</option>
                                <option value="Colima">Colima</option>
                                <option value="Durango">Durango</option>
                                <option value="Estado de M√©xico">Estado de M√©xico</option>
                                <option value="Guanajuato">Guanajuato</option>
                                <option value="Guerrero">Guerrero</option>
                                <option value="Hidalgo">Hidalgo</option>
                                <option value="Jalisco">Jalisco</option>
                                <option value="Michoac√°n">Michoac√°n</option>
                                <option value="Morelos">Morelos</option>
                                <option value="Nayarit">Nayarit</option>
                                <option value="Nuevo Le√≥n">Nuevo Le√≥n</option>
                                <option value="Oaxaca">Oaxaca</option>
                                <option value="Puebla">Puebla</option>
                                <option value="Quer√©taro">Quer√©taro</option>
                                <option value="Quintana Roo">Quintana Roo</option>
                                <option value="San Luis Potos√≠">San Luis Potos√≠</option>
                                <option value="Sinaloa">Sinaloa</option>
                                <option value="Sonora">Sonora</option>
                                <option value="Tabasco">Tabasco</option>
                                <option value="Tamaulipas">Tamaulipas</option>
                                <option value="Tlaxcala">Tlaxcala</option>
                                <option value="Veracruz">Veracruz</option>
                                <option value="Yucat√°n">Yucat√°n</option>
                                <option value="Zacatecas">Zacatecas</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Habitaciones</label>
                            <input type="number" id="habitaciones" min="0">
                        </div>

                        <div class="form-group">
                            <label>Ba√±os</label>
                            <input type="number" id="banos" min="0">
                        </div>

                        <div class="form-group">
                            <label>Estacionamientos</label>
                            <input type="number" id="estacionamientos" min="0">
                        </div>

                        <div class="form-group">
                            <label>m¬≤</label>
                            <input type="number" id="metros_cuadrados" step="0.01" min="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Estado de Propiedad</label>
                            <select id="estado_propiedad">
                                <option value="venta">En Venta</option>
                                <option value="renta">En Renta</option>
                                <option value="vendida">Vendida</option>
                                <option value="rentada">Rentada</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="destacada">
                                <span>Propiedad Destacada</span>
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; margin-top: 0.5rem;">
                                <input type="checkbox" id="en_carousel">
                                <span>Mostrar en Carrusel</span>
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; margin-top: 0.5rem;">
                                <input type="checkbox" id="mejor_venta">
                                <span>Mejor Venta</span>
                            </label>
                            <label
                                style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; margin-top: 0.5rem;">
                                <input type="checkbox" id="mejor_renta">
                                <span>Mejor Renta</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Im√°genes (M√°x 6)</label>
                            <div id="imagePreviewContainer"
                                style="margin-bottom: 10px; display: flex; flex-wrap: wrap; gap: 10px;">
                                <!-- Thumbnails will be injected here -->
                            </div>
                            <input type="file" id="imagen_file" multiple accept="image/*">
                            <input type="hidden" id="imagen_principal">
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-danger" id="cancelModal">
                            <span class="material-icons">close</span>
                            Cancelar
                        </button>
                        <button type="submit" class="btn-success">
                            <span class="material-icons">check</span>
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL: Agregar/Editar Agente ==================== -->
    <div id="agentModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="agentModalTitle">Agregar Agente</h2>
                <button class="modal-close" id="closeAgentModal">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="agentForm">
                    <input type="hidden" id="agentId">

                    <div class="form-row">
                        <div class="form-group">
                            <label>Nombre</label>
                            <input type="text" id="agentNombre" required>
                        </div>
                        <div class="form-group">
                            <label>Apellido</label>
                            <input type="text" id="agentApellido" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Imagen de Perfil</label>
                            <input type="file" id="agentImagen" accept="image/*">
                            <input type="hidden" id="agentImagenUrl">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="agentEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Tel√©fono</label>
                            <input type="text" id="agentTelefono" maxlength="10" placeholder="10 d√≠gitos">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Cargo</label>
                            <input type="text" id="agentCargo">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Antig√ºedad</label>
                            <input type="text" id="agentAntiguedad" placeholder="Ej: 5 a√±os">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="agentActivo" checked>
                                <span>Agente Activo</span>
                            </label>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button type="button" class="btn-danger" id="cancelAgentModal">
                            <span class="material-icons">close</span>
                            Cancelar
                        </button>
                        <button type="submit" class="btn-success">
                            <span class="material-icons">check</span>
                            Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ==================== MODAL: Asignar Propiedades ==================== -->
    <div id="assignModal" class="modal" style="display: none;">
        <div class="modal-content modal-wide">
            <div class="modal-header">
                <h2 id="assignModalTitle">Asignar Propiedades</h2>
                <button class="modal-close" id="closeAssignModal">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="assign-subtitle" id="assignSubtitle">Selecciona las propiedades para este agente</p>
                <div class="assign-search">
                    <span class="material-icons">search</span>
                    <input type="text" id="assignSearchInput" placeholder="Filtrar propiedades...">
                </div>
                <div class="assign-properties-list" id="assignPropertiesList">
                    <p style="text-align:center;color:#64748B;">Cargando propiedades...</p>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancelAssignModal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal modal-success" style="display: none;">
        <div class="modal-content modal-sm">
            <div class="success-icon">
                <span class="material-icons">check</span>
            </div>
            <h2 class="success-title" id="successTitle">¬°√âxito!</h2>
            <p class="success-message" id="successMessage">Operaci√≥n realizada correctamente.</p>
            <button class="btn-success-modal" id="btnSuccessClose">Aceptar</button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal modal-danger" style="display: none;">
        <div class="modal-content modal-sm">
            <div class="success-icon">
                <span class="material-icons">warning</span>
            </div>
            <h2 class="success-title" id="confirmTitle">¬øEst√°s seguro?</h2>
            <p class="success-message" id="confirmMessage">Esta acci√≥n no se puede deshacer.</p>
            <div class="modal-actions" style="justify-content: center; gap: 1rem;">
                <button class="btn-secondary" id="btnConfirmCancel" style="width: 48%;">
                    <span class="material-icons">close</span>
                    Cancelar
                </button>
                <button class="btn-danger" id="btnConfirmAction" style="width: 48%;">
                    <span class="material-icons">delete</span>
                    Eliminar
                </button>
            </div>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="admin.js"></script>
</body>

</html>